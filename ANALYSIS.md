# Анализ проекта Detail Lab

## Текущий стек технологий
*   **Frontend:** React 18, Vite, TypeScript, Tailwind CSS.
*   **UI-компоненты:** Radix UI, Lucide React, Framer Motion, Shadcn/UI.
*   **Backend/База данных:** Supabase (PostgreSQL).
*   **Состояние:** В проекте присутствуют следы миграций между Firebase, Supabase и Cloudflare D1.

## Основные проблемы архитектуры
1.  **Избыточная загрузка данных:** В `AppContext.tsx` при старте приложения загружаются все данные (сотрудники, организации, услуги, все записи). Это приведет к деградации производительности при росте базы данных.
2.  **Стейт-менеджмент:** Использование одного глобального контекста для всех данных вызывает избыточные перерисовки.
3.  **Смешение логики бэкендов:** Файлы вроде `useFirebaseData.ts` содержат логику Supabase, что вводит в заблуждение.

## Сравнение Supabase и Firebase
*   **Supabase (PostgreSQL):**
    *   *Плюсы:* Идеально подходит для реляционных данных автомойки. Позволяет делать сложные отчеты и агрегацию (например, расчет ЗП за месяц) прямо на сервере, что экономит трафик и ресурсы телефона.
    *   *Минусы:* Требует описания схемы данных. Однако визуальный **Table Editor** позволяет добавлять колонки без написания SQL-кода.
*   **Firebase (Firestore):**
    *   *Плюсы:* NoSQL база, удобная для быстрого прототипирования ("бросил и сохранил"). Не требует жесткой схемы.
    *   *Минусы:* Сложно делать аналитику. Для расчета ЗП за период придется скачивать ВСЕ записи за этот период на клиент, что станет проблемой при росте данных.

**Рекомендация:** Оставаться на Supabase. Для бизнеса с четкой структурой данных (записи, цены, сотрудники) реляционная база — более надежный фундамент на долгий срок.

## Рекомендации по масштабированию
1.  **Внедрение React Query (TanStack Query):** Для управления серверным состоянием, кэширования и автоматической обработки состояний загрузки.
2.  **Серверная пагинация:** Использование `.range()` в Supabase для загрузки данных частями.
3.  **Разделение контекстов:** Разбить `AppContext` на несколько тематических контекстов или полностью перейти на React Query.
4.  **Рефакторинг сервисного слоя:** Очистка `src/lib/services/` от остатков старых бэкендов и разделение по доменам.
